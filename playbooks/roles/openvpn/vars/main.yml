---
openvpn_days_valid: "1825"
openvpn_request_subject: "/C={{ openvpn_key_country }}/ST={{ openvpn_key_province }}/L={{ openvpn_key_city }}/O={{ openvpn_key_org }}/OU={{ openvpn_key_ou }}"
openvpn_path: "/etc/openvpn"
openvpn_ca: "{{ openvpn_path }}/ca"
openvpn_hmac_firewall: "{{ openvpn_path }}/ta.key"
openvpn_server: "{{ streisand_ipv4_address }}"
openvpn_server_common_name_file: "{{ openvpn_path }}/openvpn_server_common_name"

openvpn_direct_profile_filename:     "{{ openvpn_server }}-direct.ovpn"
openvpn_direct_udp_profile_filename: "{{ openvpn_server }}-direct-udp.ovpn"
openvpn_sslh_profile_filename:       "{{ openvpn_server }}-sslh.ovpn"
openvpn_stunnel_profile_filename:    "{{ openvpn_server }}-stunnel.ovpn"
openvpn_combined_profile_filename:   "{{ openvpn_server }}-combined.ovpn"

dnsmasq_openvpn_tcp_ip: "10.8.0.1"
dnsmasq_openvpn_udp_ip: "10.9.0.1"

openvpn_server_tcp_ipv4_address: "10.9.0.0/24"
openvpn_server_udp_ipv4_address: "10.8.0.0/24"

dnsmasq_openvpn_tcp_ipv6: "2001:db8:0:124::1001"
dnsmasq_openvpn_udp_ipv6: "2001:db8:0:123::1001"

openvpn_server_tcp_ipv6_address: "2001:db8:0:124::/64"
openvpn_server_udp_ipv6_address: "2001:db8:0:123::/64"

openvpn_firewall_rules:
  - "iptables --wait {{ streisand_iptables_wait }} -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT"
  - "iptables --wait {{ streisand_iptables_wait }} -A FORWARD -s {{ openvpn_server_udp_ipv4_address }} -j ACCEPT"
  - "iptables --wait {{ streisand_iptables_wait }} -A FORWARD -s {{ openvpn_server_tcp_ipv4_address }} -j ACCEPT"
  - "iptables --wait {{ streisand_iptables_wait }} -t nat -A POSTROUTING -s {{ openvpn_server_udp_ipv4_address }} -o {{ ansible_default_ipv4.interface }} -j MASQUERADE"
  - "iptables --wait {{ streisand_iptables_wait }} -t nat -A POSTROUTING -s {{ openvpn_server_tcp_ipv4_address }} -o {{ ansible_default_ipv4.interface }} -j MASQUERADE"

openvpn_ipv6_firewall_rules:
  - "ip6tables --wait {{ streisand_iptables_wait }} -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT"
  - "ip6tables --wait {{ streisand_iptables_wait }} -A FORWARD -s {{ openvpn_server_tcp_ipv6_address }} -j ACCEPT"
  - "ip6tables --wait {{ streisand_iptables_wait }} -A FORWARD -s {{ openvpn_server_udp_ipv6_address }} -j ACCEPT"
  - "ip6tables --wait {{ streisand_iptables_wait }} -t nat -A POSTROUTING -s {{ openvpn_server_tcp_ipv6_address }} -o {{ ansible_default_ipv4.interface }} -j MASQUERADE"
  - "ip6tables --wait {{ streisand_iptables_wait }} -t nat -A POSTROUTING -s {{ openvpn_server_udp_ipv6_address }} -o {{ ansible_default_ipv6.interface }} -j MASQUERADE"

openvpn_gateway_location: "{{ streisand_gateway_location }}/openvpn"

openvpn_service_names:
  - "openvpn@server.service"
  - "openvpn@server-udp.service"
